---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.3
  name: synctargets.workload.kcp.io
spec:
  group: workload.kcp.io
  names:
    categories:
    - kcp
    kind: SyncTarget
    listKind: SyncTargetList
    plural: synctargets
    singular: synctarget
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.cells[0].name
      name: Location
      type: string
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .status.syncerIdentity
      name: Syncer
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: |-
          SyncTarget defines a physical cluster target for workload synchronization.
          It represents a physical cluster that can host workloads in the TMC system,
          providing the foundation for multi-cluster workload placement and management.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: Spec defines the desired state of the SyncTarget
            properties:
              capabilities:
                description: Capabilities defines what the target cluster supports
                properties:
                  features:
                    description: Features lists the features supported by this target
                    items:
                      type: string
                    type: array
                  maxWorkloads:
                    description: MaxWorkloads defines the maximum number of workloads
                      this target can handle
                    format: int32
                    type: integer
                  supportedResourceTypes:
                    description: SupportedResourceTypes lists the resource types this
                      target supports
                    items:
                      description: ResourceTypeSupport defines support for a specific
                        resource type
                      properties:
                        group:
                          description: Group is the API group of the resource
                          type: string
                        kind:
                          description: Kind is the resource kind
                          type: string
                        supported:
                          description: Supported indicates whether this resource type
                            is supported
                          type: boolean
                        version:
                          description: Version is the API version of the resource
                          type: string
                      required:
                      - kind
                      - version
                      type: object
                    type: array
                type: object
              cells:
                description: |-
                  Cells defines the cells this SyncTarget supports. At least one cell is required.
                  Cells represent failure domains or locations within the target cluster.
                items:
                  description: |-
                    Cell represents a failure domain or location within a SyncTarget.
                    Cells provide a way to organize and constrain workload placement within
                    a physical cluster based on topology or other characteristics.
                  properties:
                    labels:
                      additionalProperties:
                        type: string
                      description: |-
                        Labels provide additional metadata for the cell that can be used
                        for workload placement decisions and constraints
                      type: object
                    name:
                      description: Name is the unique identifier for this cell within
                        the SyncTarget
                      minLength: 1
                      type: string
                    taints:
                      description: |-
                        Taints applied to this cell that affect workload placement.
                        Workloads must tolerate these taints to be scheduled to this cell.
                      items:
                        description: Taint represents a taint on a cell that affects
                          workload placement
                        properties:
                          effect:
                            allOf:
                            - enum:
                              - NoSchedule
                              - PreferNoSchedule
                              - NoExecute
                            - enum:
                              - NoSchedule
                              - PreferNoSchedule
                              - NoExecute
                            description: |-
                              Effect indicates the taint effect to apply to workloads that do not tolerate the taint.
                              Valid effects are NoSchedule, PreferNoSchedule and NoExecute.
                            type: string
                          key:
                            description: Key is the taint key to be applied to the
                              cell
                            minLength: 1
                            type: string
                          value:
                            description: Value is the taint value corresponding to
                              the taint key
                            type: string
                        required:
                        - effect
                        - key
                        type: object
                      type: array
                  required:
                  - name
                  type: object
                minItems: 1
                type: array
              connection:
                description: Connection defines how to connect to the target cluster
                properties:
                  caBundle:
                    description: CABundle is the base64-encoded CA certificate bundle
                      for TLS verification
                    format: byte
                    type: string
                  insecureSkipTLSVerify:
                    description: |-
                      InsecureSkipTLSVerify skips TLS certificate verification
                      This should only be used for testing
                    type: boolean
                  serverName:
                    description: ServerName is the server name to use for TLS verification
                    type: string
                  url:
                    description: URL is the API server endpoint URL for the target
                      cluster
                    format: uri
                    type: string
                required:
                - url
                type: object
              credentials:
                description: Credentials defines authentication credentials for the
                  target cluster
                properties:
                  certificate:
                    description: Certificate contains client certificate authentication
                      details
                    properties:
                      clientCert:
                        description: ClientCert is the base64-encoded client certificate
                        format: byte
                        type: string
                      clientKey:
                        description: ClientKey is the base64-encoded client private
                          key
                        format: byte
                        type: string
                    required:
                    - clientCert
                    - clientKey
                    type: object
                  serviceAccount:
                    description: ServiceAccount references a service account for authentication
                    properties:
                      name:
                        description: Name is the name of the service account
                        type: string
                      namespace:
                        description: Namespace is the namespace of the service account
                        type: string
                    required:
                    - name
                    - namespace
                    type: object
                  token:
                    description: Token contains bearer token authentication details
                    properties:
                      value:
                        description: Value is the bearer token value
                        type: string
                    required:
                    - value
                    type: object
                  type:
                    description: Type specifies the authentication type (token, certificate,
                      etc.)
                    enum:
                    - token
                    - certificate
                    - serviceAccount
                    type: string
                required:
                - type
                type: object
              evictAfter:
                description: |-
                  EvictAfter defines when to evict workloads after target becomes unhealthy.
                  This provides a grace period for the target to recover before workloads are moved.
                format: duration
                type: string
              supportedAPIExports:
                description: |-
                  SupportedAPIExports defines which APIs this target can sync.
                  This allows the target to advertise which APIs it supports for workload placement.
                items:
                  description: APIExportReference references an APIExport that this
                    SyncTarget supports
                  properties:
                    name:
                      description: Name is the name of the APIExport within the workspace
                      minLength: 1
                      type: string
                    workspace:
                      description: Workspace is the logical cluster workspace containing
                        the APIExport
                      minLength: 1
                      type: string
                  required:
                  - name
                  - workspace
                  type: object
                type: array
              unschedulable:
                description: |-
                  Unschedulable marks this SyncTarget as unavailable for new workloads.
                  When true, new workloads will not be scheduled to this target, but existing
                  workloads will continue to run.
                type: boolean
            required:
            - cells
            type: object
          status:
            description: Status defines the observed state of the SyncTarget
            properties:
              allocatable:
                additionalProperties:
                  anyOf:
                  - type: integer
                  - type: string
                  pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                  x-kubernetes-int-or-string: true
                description: Allocatable resources on this target available for workload
                  placement
                type: object
              capacity:
                additionalProperties:
                  anyOf:
                  - type: integer
                  - type: string
                  pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                  x-kubernetes-int-or-string: true
                description: Capacity defines the total resources available on this
                  target
                type: object
              conditions:
                description: |-
                  Conditions represent the current status conditions of the SyncTarget.
                  Known condition types include Ready and Heartbeat.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              connectionState:
                description: ConnectionState represents the current connection state
                  to the target cluster
                type: string
              health:
                description: Health represents the overall health status of the target
                properties:
                  checks:
                    description: Checks contains individual health check results
                    items:
                      description: HealthCheck represents an individual health check
                        result
                      properties:
                        lastChecked:
                          description: LastChecked is when this check was last performed
                          format: date-time
                          type: string
                        message:
                          description: Message provides details about the health check
                            result
                          type: string
                        name:
                          description: Name is the name of the health check
                          type: string
                        status:
                          description: Status is the result of this health check
                          enum:
                          - Passed
                          - Failed
                          - Unknown
                          type: string
                      required:
                      - name
                      - status
                      type: object
                    type: array
                  lastChecked:
                    description: LastChecked is when the health was last checked
                    format: date-time
                    type: string
                  message:
                    description: Message provides additional context about the health
                      status
                    type: string
                  status:
                    description: Status is the overall health status
                    enum:
                    - Healthy
                    - Degraded
                    - Unhealthy
                    - Unknown
                    type: string
                required:
                - status
                type: object
              lastHeartbeatTime:
                description: |-
                  LastHeartbeatTime is when the syncer last sent a heartbeat for this target.
                  This is used to determine if the target is still healthy and reachable.
                format: date-time
                type: string
              syncState:
                description: SyncState represents the current synchronization state
                type: string
              syncedResources:
                description: SyncedResources lists the resources currently being synced
                  to this target
                items:
                  description: SyncedResourceStatus represents the status of a synced
                    resource
                  properties:
                    error:
                      description: Error contains any error encountered during sync
                      type: string
                    group:
                      description: Group is the API group of the resource
                      type: string
                    kind:
                      description: Kind is the resource kind
                      type: string
                    lastSyncTime:
                      description: LastSyncTime is when this resource was last successfully
                        synced
                      format: date-time
                      type: string
                    name:
                      description: Name is the resource name
                      type: string
                    namespace:
                      description: Namespace is the resource namespace (if namespaced)
                      type: string
                    syncState:
                      description: SyncState is the current sync state of this resource
                      type: string
                    version:
                      description: Version is the API version of the resource
                      type: string
                  required:
                  - kind
                  - name
                  - version
                  type: object
                type: array
              syncerIdentity:
                description: |-
                  SyncerIdentity identifies the syncer component managing this target.
                  This is used to track which syncer instance is responsible for synchronization.
                type: string
              virtualWorkspaces:
                description: |-
                  VirtualWorkspaces contains the virtual workspace URLs through which this target is exposed.
                  These URLs allow clients to interact with resources on this target.
                items:
                  description: VirtualWorkspace represents a virtual workspace URL
                    for accessing the SyncTarget
                  properties:
                    url:
                      description: URL is the virtual workspace URL for accessing
                        resources on this SyncTarget
                      format: uri
                      type: string
                  required:
                  - url
                  type: object
                type: array
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
